Copyed from spark master [commit 908e37bcc10132bb2aa7f80ae694a9df6e40f31a]
