Copyed from the spark v2.2.0 release.
